<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Birthday Timeline</title>
<style>
  body {
    margin: 0;
    font-family: 'Poppins', sans-serif;
    background: #fff8f0;
    overflow-x: hidden;
  }

  h1 {
    text-align: center;
    margin-top: 30px;
    color: #ff7b54;
  }

  .timeline {
    position: relative;
    width: 100%;
    padding: 100px 0 200px;
  }

  /* Curved dotted path */
  svg.curve-line {
  position: absolute;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100%;
  overflow: visible;
  z-index: 0;
}


  svg.curve-line path {
    fill: none;
    stroke: #ff7b54;
    stroke-width: 4;
    stroke-dasharray: 8, 10;
  }

  /* Polaroid frames */
  .polaroid {
    position: relative;
    width: 200px;
    background: white;
    padding: 10px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    margin: 80px 0;
    border: 3px solid #fff;
    border-radius: 8px;
    transform: rotate(var(--angle));
    z-index: 1;
  }

  .polaroid img {
    width: 100%;
    border-radius: 4px;
  }

  .polaroid p {
    text-align: center;
    font-size: 14px;
    margin-top: 5px;
  }

  .container {
    position: relative;
    width: 50%;
    padding: 20px 40px;
  }

  .container.left { left: 0; text-align: right; }
  .container.right { left: 50%; }

  /* Cake container */
  .cake-container {
    text-align: center;
    margin-top: 180px;
  }

  /* Fancy cake */
  .cake {
    position: relative;
    margin: 0 auto;
    width: 220px;
    height: 120px;
    background: linear-gradient(to bottom, #ffb6b9, #ff9aa2);
    border-radius: 0 0 100px 100px / 0 0 60px 60px;
    box-shadow: inset 0 -10px 0 rgba(0,0,0,0.05), 0 6px 10px rgba(0,0,0,0.2);
  }

  .cake::before {
    content: "";
    position: absolute;
    top: -30px;
    left: 0;
    width: 100%;
    height: 40px;
    background: linear-gradient(to bottom, #fff, #ffe6e6);
    border-radius: 100px 100px 0 0 / 40px 40px 0 0;
    box-shadow: inset 0 -5px 0 rgba(0,0,0,0.05);
  }

  /* Candles around top + half side */
  .candle {
    position: absolute;
    width: 8px;
    height: 40px;
    background: #ffd700;
    border-radius: 2px;
    transform-origin: bottom center;
  }

  .flame {
    position: absolute;
    top: -15px;
    left: 50%;
    width: 10px;
    height: 15px;
    background: orange;
    border-radius: 50%;
    transform: translateX(-50%);
    animation: flicker 0.3s infinite;
  }

  @keyframes flicker {
    0%,100% { opacity: 1; transform: translateX(-50%) scale(1); }
    50% { opacity: 0.7; transform: translateX(-50%) scale(0.9); }
  }
</style>
</head>
<body>

<h1>Happy 14th Birthday ðŸŽ‰</h1>

<div class="timeline">
  <svg class="curve-line" xmlns="http://www.w3.org/2000/svg">
    <path id="timelinePath" />
  </svg>

  <!-- Generate photos -->
  <script>
    const timeline = document.querySelector('.timeline');
    for (let i = 1; i <= 14; i++) {
      const side = i % 2 === 0 ? 'right' : 'left';
      const container = document.createElement('div');
      container.className = `container ${side}`;

      const polaroid = document.createElement('div');
      polaroid.className = 'polaroid';
      polaroid.style.setProperty('--angle', `${(Math.random() - 0.5) * 10}deg`);
      polaroid.innerHTML = `<img src="https://picsum.photos/200?random=${i}" alt="Memory ${i}">
      <p>Memory ${i}</p>`;

      container.appendChild(polaroid);
      timeline.appendChild(container);
    }
  </script>

  <!-- Cake -->
  <div class="cake-container">
    <div class="cake" id="cake"></div>
    <p>Blow out the candles! ðŸŽ‚</p>
  </div>
</div>

<script>
function drawTimelineCurve() {
  const path = document.getElementById('timelinePath');
  const containers = document.querySelectorAll('.container');
  if (!containers.length) return;

  const xCenter = window.innerWidth / 2;
  let d = `M ${xCenter} 0 `;
  
  containers.forEach((el, i) => {
    const rect = el.getBoundingClientRect();
    const yPos = window.scrollY + rect.top + rect.height / 2;
    const offsetBase = Math.min(window.innerWidth * 0.25, 300); // adapt curve width
    const direction = el.classList.contains('left') ? -1 : 1;
    const xTarget = xCenter + direction * offsetBase;

    // Smooth curve control points
    const prevY = i === 0 ? 0 : (window.scrollY + containers[i - 1].getBoundingClientRect().top + containers[i - 1].getBoundingClientRect().height / 2);
    const midY = (prevY + yPos) / 2;
    const tension = Math.min(150, window.innerHeight * 0.15);

    d += `C ${xCenter} ${midY - tension}, ${xTarget} ${midY + tension / 2}, ${xTarget} ${yPos}`;
  });

  path.setAttribute('d', d);
}

// Recalculate dynamically
['load', 'resize', 'scroll'].forEach(evt => window.addEventListener(evt, () => {
  cancelAnimationFrame(window.timelineRaf);
  window.timelineRaf = requestAnimationFrame(drawTimelineCurve);
}));
</script>


<script>
  // Generate half-circle candles
  const cake = document.getElementById('cake');
  const totalCandles = 14;
  const radius = 100;
  const centerX = 110;
  const centerY = 30;

  for (let i = 0; i < totalCandles; i++) {
    const angle = (Math.PI * i) / (totalCandles - 1);
    const x = centerX + radius * Math.cos(angle);
    const y = centerY - radius * Math.sin(angle) * 0.5;

    const candle = document.createElement('div');
    candle.className = 'candle';
    candle.style.left = `${x - 4}px`;
    candle.style.bottom = `${y + 60}px`;
    candle.style.transform = `rotate(${(Math.random() - 0.5) * 10}deg)`;

    const flame = document.createElement('div');
    flame.className = 'flame';
    candle.appendChild(flame);
    cake.appendChild(candle);
  }

  // Blow-out feature
  navigator.mediaDevices.getUserMedia({ audio: true })
    .then(stream => {
      const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      const analyser = audioCtx.createAnalyser();
      const source = audioCtx.createMediaStreamSource(stream);
      source.connect(analyser);
      const dataArray = new Uint8Array(analyser.fftSize);
      
      function detectBlow() {
        analyser.getByteFrequencyData(dataArray);
        const volume = dataArray.reduce((a, b) => a + b) / dataArray.length;
        if (volume > 80) {
          document.querySelectorAll('.flame').forEach(f => f.style.display = 'none');
        }
        requestAnimationFrame(detectBlow);
      }
      detectBlow();
    })
    .catch(() => alert('Please enable your microphone to blow out the candles.'));
</script>

</body>
</html>
